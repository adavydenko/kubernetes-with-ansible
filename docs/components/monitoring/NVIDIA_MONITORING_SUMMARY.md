# üéÆ NVIDIA GPU Monitoring - –°–≤–æ–¥–∫–∞

## üéØ –ß—Ç–æ –¥–æ–±–∞–≤–ª–µ–Ω–æ

### 1. NVIDIA Node Exporter –ø–æ–¥–¥–µ—Ä–∂–∫–∞:
- **DaemonSet** - –∑–∞–ø—É—Å–∫–∞–µ—Ç—Å—è –Ω–∞ —É–∑–ª–∞—Ö —Å GPU
- **DCGM Exporter** - —Å–±–æ—Ä –º–µ—Ç—Ä–∏–∫ GPU
- **–ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è —Å Prometheus** - –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–π —Å–±–æ—Ä
- **–ì–æ—Ç–æ–≤—ã–µ –∞–ª–µ—Ä—Ç—ã** - –¥–ª—è –∫—Ä–∏—Ç–∏—á–µ—Å–∫–∏—Ö —Å–æ–±—ã—Ç–∏–π GPU

### 2. –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è:
- **`monitoring/defaults/main.yml`** - –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ NVIDIA Exporter
- **`monitoring/tasks/main.yml`** - –∑–∞–¥–∞—á–∏ —É—Å—Ç–∞–Ω–æ–≤–∫–∏
- **`examples/nvidia-monitoring-example.yml`** - –ø—Ä–∏–º–µ—Ä—ã –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏

### 3. –î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è:
- **`QUICK_START_NVIDIA_MONITORING.md`** - –±—ã—Å—Ç—Ä—ã–π —Å—Ç–∞—Ä—Ç
- **`NVIDIA_MONITORING_SUMMARY.md`** - —ç—Ç–∞ —Å–≤–æ–¥–∫–∞

## üöÄ –ö–∞–∫ –≤–∫–ª—é—á–∏—Ç—å

### 1. –í–∫–ª—é—á–µ–Ω–∏–µ NVIDIA –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥–∞:
```yaml
# –í monitoring/defaults/main.yml
nvidia_exporter_enabled: true
```

### 2. –ü–µ—Ä–µ—É—Å—Ç–∞–Ω–æ–≤–∫–∞:
```bash
ansible-playbook -i inventory.yml site.yml --tags monitoring
```

### 3. –ü—Ä–æ–≤–µ—Ä–∫–∞:
```bash
kubectl get pods -n monitoring -l app=nvidia-exporter
```

## üìä –ß—Ç–æ –º–æ–Ω–∏—Ç–æ—Ä–∏—Ç—Å—è

### GPU –º–µ—Ç—Ä–∏–∫–∏:
- **–ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ GPU** - –∑–∞–≥—Ä—É–∑–∫–∞ –ø—Ä–æ—Ü–µ—Å—Å–æ—Ä–∞ GPU
- **–ü–∞–º—è—Ç—å GPU** - –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–Ω–∞—è –∏ –¥–æ—Å—Ç—É–ø–Ω–∞—è –ø–∞–º—è—Ç—å
- **–¢–µ–º–ø–µ—Ä–∞—Ç—É—Ä–∞** - —Ç–µ–º–ø–µ—Ä–∞—Ç—É—Ä–∞ GPU
- **–ü–æ—Ç—Ä–µ–±–ª–µ–Ω–∏–µ —ç–Ω–µ—Ä–≥–∏–∏** - –º–æ—â–Ω–æ—Å—Ç—å –≤ –≤–∞—Ç—Ç–∞—Ö
- **–°–∫–æ—Ä–æ—Å—Ç—å –≤–µ–Ω—Ç–∏–ª—è—Ç–æ—Ä–∞** - –æ–±–æ—Ä–æ—Ç—ã –≤–µ–Ω—Ç–∏–ª—è—Ç–æ—Ä–∞

### –û—Å–Ω–æ–≤–Ω—ã–µ –º–µ—Ç—Ä–∏–∫–∏:
```yaml
DCGM_FI_DEV_GPU_UTIL        # –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ GPU (%)
DCGM_FI_DEV_FB_USED         # –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–Ω–∞—è –ø–∞–º—è—Ç—å (bytes)
DCGM_FI_DEV_FB_TOTAL        # –û–±—â–∞—è –ø–∞–º—è—Ç—å (bytes)
DCGM_FI_DEV_GPU_TEMP        # –¢–µ–º–ø–µ—Ä–∞—Ç—É—Ä–∞ (¬∞C)
DCGM_FI_DEV_POWER_USAGE     # –ü–æ—Ç—Ä–µ–±–ª–µ–Ω–∏–µ —ç–Ω–µ—Ä–≥–∏–∏ (W)
DCGM_FI_DEV_FAN_SPEED       # –°–∫–æ—Ä–æ—Å—Ç—å –≤–µ–Ω—Ç–∏–ª—è—Ç–æ—Ä–∞ (%)
```

## üéØ –ü—Ä–µ–∏–º—É—â–µ—Å—Ç–≤–∞

### –î–ª—è –∫–ª–∞—Å—Ç–µ—Ä–∞ —Å GPU:
- ‚úÖ **–ü–æ–ª–Ω—ã–π –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ GPU** - –≤—Å–µ –≤–∞–∂–Ω—ã–µ –º–µ—Ç—Ä–∏–∫–∏
- ‚úÖ **–ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–µ –∞–ª–µ—Ä—Ç—ã** - –ø–µ—Ä–µ–≥—Ä–µ–≤, –≤—ã—Å–æ–∫–∞—è –∑–∞–≥—Ä—É–∑–∫–∞
- ‚úÖ **–ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è —Å Grafana** - –∫—Ä–∞—Å–∏–≤—ã–µ –¥–∞—à–±–æ—Ä–¥—ã
- ‚úÖ **–ú–∞—Å—à—Ç–∞–±–∏—Ä—É–µ–º–æ—Å—Ç—å** - —Ä–∞–±–æ—Ç–∞–µ—Ç –Ω–∞ –≤—Å–µ—Ö —É–∑–ª–∞—Ö —Å GPU

### –ë–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å:
- ‚úÖ **Privileged –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä—ã** - –Ω–µ–æ–±—Ö–æ–¥–∏–º—ã–π –¥–æ—Å—Ç—É–ø –∫ GPU
- ‚úÖ **Tolerations** - –∑–∞–ø—É—Å–∫ —Ç–æ–ª—å–∫–æ –Ω–∞ —É–∑–ª–∞—Ö —Å GPU
- ‚úÖ **Resource limits** - –∫–æ–Ω—Ç—Ä–æ–ª—å –ø–æ—Ç—Ä–µ–±–ª–µ–Ω–∏—è —Ä–µ—Å—É—Ä—Å–æ–≤

## üö® –ì–æ—Ç–æ–≤—ã–µ –∞–ª–µ—Ä—Ç—ã

### –ö—Ä–∏—Ç–∏—á–µ—Å–∫–∏–µ –∞–ª–µ—Ä—Ç—ã:
```yaml
- HighGPUUtilization    # >90% –∑–∞–≥—Ä—É–∑–∫–∞ GPU
- GPUOverheating        # >80¬∞C —Ç–µ–º–ø–µ—Ä–∞—Ç—É—Ä–∞
- HighGPUMemoryUsage    # >85% –ø–∞–º—è—Ç—å GPU
- GPUFanFailure         # –í–µ–Ω—Ç–∏–ª—è—Ç–æ—Ä –Ω–µ —Ä–∞–±–æ—Ç–∞–µ—Ç
- GPUPowerLimit         # >95% –ª–∏–º–∏—Ç–∞ –º–æ—â–Ω–æ—Å—Ç–∏
```

### –ü—Ä–∏–º–µ–Ω–µ–Ω–∏–µ:
```bash
kubectl apply -f examples/monitoring-alerts.yml
```

## üìà –ü–æ–ª–µ–∑–Ω—ã–µ –∑–∞–ø—Ä–æ—Å—ã

### –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ GPU:
```
DCGM_FI_DEV_GPU_UTIL
```

### –ü–∞–º—è—Ç—å GPU:
```
(DCGM_FI_DEV_FB_USED / DCGM_FI_DEV_FB_TOTAL) * 100
```

### –ö–æ–ª–∏—á–µ—Å—Ç–≤–æ GPU:
```
count(DCGM_FI_DEV_GPU_UTIL)
```

### –°—Ä–µ–¥–Ω—è—è —Ç–µ–º–ø–µ—Ä–∞—Ç—É—Ä–∞:
```
avg(DCGM_FI_DEV_GPU_TEMP)
```

## üõ† –£—Å—Ç—Ä–∞–Ω–µ–Ω–∏–µ –Ω–µ–ø–æ–ª–∞–¥–æ–∫

### –ü—Ä–æ–≤–µ—Ä–∫–∞ —É—Å—Ç–∞–Ω–æ–≤–∫–∏:
```bash
# –ü—Ä–æ–≤–µ—Ä–∫–∞ –ø–æ–¥–æ–≤
kubectl get pods -n monitoring -l app=nvidia-exporter

# –ü—Ä–æ–≤–µ—Ä–∫–∞ –ª–æ–≥–æ–≤
kubectl logs -n monitoring daemonset/nvidia-exporter

# –ü—Ä–æ–≤–µ—Ä–∫–∞ –º–µ—Ç—Ä–∏–∫
kubectl port-forward -n monitoring svc/nvidia-exporter 9400:9400
curl http://localhost:9400/metrics | grep DCGM
```

### –ß–∞—Å—Ç—ã–µ –ø—Ä–æ–±–ª–µ–º—ã:
1. **–ù–µ—Ç NVIDIA –¥—Ä–∞–π–≤–µ—Ä–æ–≤** - —É—Å—Ç–∞–Ω–æ–≤–∏—Ç–µ –Ω–∞ —É–∑–ª–∞—Ö
2. **–ù–µ—Ç Container Runtime** - –Ω–∞—Å—Ç—Ä–æ–π—Ç–µ NVIDIA Container Runtime
3. **–ü—Ä–æ–±–ª–µ–º—ã —Å –ø—Ä–∞–≤–∞–º–∏** - –ø—Ä–æ–≤–µ—Ä—å—Ç–µ security context
4. **–ù–µ—Ç GPU –Ω–∞ —É–∑–ª–µ** - –ø—Ä–æ–≤–µ—Ä—å—Ç–µ tolerations

## üìÅ –°—Ç—Ä—É–∫—Ç—É—Ä–∞ —Ñ–∞–π–ª–æ–≤

```
monitoring/
‚îú‚îÄ‚îÄ defaults/main.yml          # –ù–∞—Å—Ç—Ä–æ–π–∫–∏ NVIDIA Exporter
‚îî‚îÄ‚îÄ tasks/main.yml             # –ó–∞–¥–∞—á–∏ —É—Å—Ç–∞–Ω–æ–≤–∫–∏

examples/
‚îî‚îÄ‚îÄ nvidia-monitoring-example.yml  # –ü—Ä–∏–º–µ—Ä—ã –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏

QUICK_START_NVIDIA_MONITORING.md   # –ë—ã—Å—Ç—Ä—ã–π —Å—Ç–∞—Ä—Ç
NVIDIA_MONITORING_SUMMARY.md       # –≠—Ç–∞ —Å–≤–æ–¥–∫–∞
```

## üéØ –†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏

### –î–ª—è –∫–ª–∞—Å—Ç–µ—Ä–∞ –∏–∑ 10 –º–∞—à–∏–Ω —Å GPU:

1. **–ù–∞—á–Ω–∏—Ç–µ —Å –±–∞–∑–æ–≤–æ–≥–æ –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥–∞** - CPU, –ø–∞–º—è—Ç—å, –¥–∏—Å–∫
2. **–î–æ–±–∞–≤—å—Ç–µ GPU –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥** - –µ—Å–ª–∏ –µ—Å—Ç—å GPU
3. **–ù–∞—Å—Ç—Ä–æ–π—Ç–µ –∞–ª–µ—Ä—Ç—ã** - –¥–ª—è –∫—Ä–∏—Ç–∏—á–µ—Å–∫–∏—Ö —Å–æ–±—ã—Ç–∏–π
4. **–ú–æ–Ω–∏—Ç–æ—Ä—å—Ç–µ —Ç–µ–º–ø–µ—Ä–∞—Ç—É—Ä—É** - –∏–∑–±–µ–≥–∞–π—Ç–µ –ø–µ—Ä–µ–≥—Ä–µ–≤–∞
5. **–û–ø—Ç–∏–º–∏–∑–∏—Ä—É–π—Ç–µ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ** - –∞–Ω–∞–ª–∏–∑–∏—Ä—É–π—Ç–µ –º–µ—Ç—Ä–∏–∫–∏

### –û–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏:

1. **–ù–∞—Å—Ç—Ä–æ–π—Ç–µ retention** - GPU –º–µ—Ç—Ä–∏–∫–∏ –∑–∞–Ω–∏–º–∞—é—Ç –º–Ω–æ–≥–æ –º–µ—Å—Ç–∞
2. **–ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ —Ñ–∏–ª—å—Ç—Ä—ã** - –∏—Å–∫–ª—é—á–∏—Ç–µ –Ω–µ–Ω—É–∂–Ω—ã–µ –º–µ—Ç—Ä–∏–∫–∏
3. **–ú–æ–Ω–∏—Ç–æ—Ä—å—Ç–µ —Ä–µ—Å—É—Ä—Å—ã** - —Å–∞–º —ç–∫—Å–ø–æ—Ä—Ç–µ—Ä –ø–æ—Ç—Ä–µ–±–ª—è–µ—Ç —Ä–µ—Å—É—Ä—Å—ã
4. **–†–µ–≥—É–ª—è—Ä–Ω–æ –æ–±–Ω–æ–≤–ª—è–π—Ç–µ** - –¥—Ä–∞–π–≤–µ—Ä—ã –∏ —ç–∫—Å–ø–æ—Ä—Ç–µ—Ä

## üîÑ –°–ª–µ–¥—É—é—â–∏–µ —à–∞–≥–∏

1. ‚úÖ **NVIDIA –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ –≥–æ—Ç–æ–≤**
2. üîÑ **–ù–∞—Å—Ç—Ä–æ–π—Ç–µ –¥–∞—à–±–æ—Ä–¥—ã –≤ Grafana**
3. üîÑ **–ù–∞—Å—Ç—Ä–æ–π—Ç–µ –∞–ª–µ—Ä—Ç—ã**
4. üîÑ **–û–ø—Ç–∏–º–∏–∑–∏—Ä—É–π—Ç–µ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ GPU**
5. üîÑ **–ù–∞—Å—Ç—Ä–æ–π—Ç–µ –±—ç–∫–∞–ø—ã –º–µ—Ç—Ä–∏–∫**

## üìö –î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–µ —Ä–µ—Å—É—Ä—Å—ã

- [NVIDIA DCGM Documentation](https://docs.nvidia.com/datacenter/dcgm/)
- [DCGM Exporter GitHub](https://github.com/NVIDIA/dcgm-exporter)
- [GPU Monitoring Best Practices](https://docs.nvidia.com/datacenter/cloud-native/kubernetes/monitoring.html)
- [–ü—Ä–∏–º–µ—Ä—ã –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏](examples/nvidia-monitoring-example.yml)

## üéÆ –ò—Ç–æ–≥

NVIDIA Node Exporter –¥–æ–±–∞–≤–ª–µ–Ω –≤ —Å–∏—Å—Ç–µ–º—É –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥–∞ –∏ –≥–æ—Ç–æ–≤ –∫ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—é. –ü—Ä–∏ –Ω–∞–ª–∏—á–∏–∏ GPU –≤ –∫–ª–∞—Å—Ç–µ—Ä–µ –≤—ã –ø–æ–ª—É—á–∏—Ç–µ:

- ‚úÖ **–ü–æ–ª–Ω—ã–π –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ GPU** —Ä–µ—Å—É—Ä—Å–æ–≤
- ‚úÖ **–ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–µ –∞–ª–µ—Ä—Ç—ã** –Ω–∞ –∫—Ä–∏—Ç–∏—á–µ—Å–∫–∏–µ —Å–æ–±—ã—Ç–∏—è
- ‚úÖ **–ö—Ä–∞—Å–∏–≤—ã–µ –¥–∞—à–±–æ—Ä–¥—ã** –≤ Grafana
- ‚úÖ **–ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—é** —Å —Å—É—â–µ—Å—Ç–≤—É—é—â–µ–π —Å–∏—Å—Ç–µ–º–æ–π –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥–∞

–î–ª—è –≤–∫–ª—é—á–µ–Ω–∏—è –¥–æ—Å—Ç–∞—Ç–æ—á–Ω–æ —É—Å—Ç–∞–Ω–æ–≤–∏—Ç—å `nvidia_exporter_enabled: true` –∏ –ø–µ—Ä–µ–∑–∞–ø—É—Å—Ç–∏—Ç—å –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥!
